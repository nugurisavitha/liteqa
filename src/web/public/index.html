<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LiteQA - Test Automation Platform</title>
  <link rel="stylesheet" href="/styles.css">
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body>
  <div id="app">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="logo">
        <h1>LiteQA</h1>
        <span class="version">v1.0.0</span>
      </div>

      <nav class="nav">
        <a href="#" class="nav-item active" data-view="dashboard">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="7" height="7"></rect>
            <rect x="14" y="3" width="7" height="7"></rect>
            <rect x="14" y="14" width="7" height="7"></rect>
            <rect x="3" y="14" width="7" height="7"></rect>
          </svg>
          Dashboard
        </a>
        <a href="#" class="nav-item" data-view="builder">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="12" y1="8" x2="12" y2="16"></line>
            <line x1="8" y1="12" x2="16" y2="12"></line>
          </svg>
          Visual Builder
        </a>
        <a href="#" class="nav-item" data-view="flows">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
            <line x1="16" y1="13" x2="8" y2="13"></line>
            <line x1="16" y1="17" x2="8" y2="17"></line>
          </svg>
          Test Flows
        </a>
        <a href="#" class="nav-item" data-view="runner">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="5 3 19 12 5 21 5 3"></polygon>
          </svg>
          Test Runner
        </a>
        <a href="#" class="nav-item" data-view="reports">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="20" x2="18" y2="10"></line>
            <line x1="12" y1="20" x2="12" y2="4"></line>
            <line x1="6" y1="20" x2="6" y2="14"></line>
          </svg>
          Reports
        </a>
        <a href="#" class="nav-item" data-view="performance">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"></path>
          </svg>
          Performance
        </a>
        <a href="#" class="nav-item" data-view="repository">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
            <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
            <line x1="12" y1="22.08" x2="12" y2="12"></line>
          </svg>
          Object Repository
        </a>
        <a href="#" class="nav-item" data-view="editor">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
          </svg>
          Flow Editor
        </a>
        <a href="#" class="nav-item" data-view="settings">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"></circle>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
          </svg>
          Settings
        </a>
      </nav>
      <div class="sidebar-footer">
        <div class="connection-status" id="connectionStatus">
          <span class="status-dot"></span>
          <span>Disconnected</span>
        </div>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main">
      <!-- Dashboard View -->
      <section id="view-dashboard" class="view active">
        <header class="view-header">
          <h2>Dashboard</h2>
          <div class="header-actions">
            <div class="project-selector-header">
              <label>Project:</label>
              <select id="project-select" class="project-dropdown" onchange="app.switchProject(this.value)">
                <option value="">Select a project...</option>
                <option value="__create__">+ Create New Project</option>
              </select>
            </div>
            <button class="btn btn-primary" onclick="app.runAllTests()">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                <polygon points="5 3 19 12 5 21 5 3"></polygon>
              </svg>
              Run All Tests
            </button>
          </div>
        </header>

        <div class="dashboard-grid">
          <div class="card stat-card clickable" onclick="app.showView('flows')">
            <div class="stat-icon flows">
              <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              </svg>
            </div>
            <div class="stat-content">
              <span class="stat-value" id="stat-flows">0</span>
              <span class="stat-label">Test Flows</span>
            </div>
          </div>

          <div class="card stat-card clickable" onclick="app.showView('reports')">
            <div class="stat-icon passed">
              <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="20 6 9 17 4 12"></polyline>
              </svg>
            </div>
            <div class="stat-content">
              <span class="stat-value" id="stat-passed">0</span>
              <span class="stat-label">Passed</span>
            </div>
          </div>

          <div class="card stat-card clickable" onclick="app.showView('reports')">
            <div class="stat-icon failed">
              <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
              </svg>
            </div>
            <div class="stat-content">
              <span class="stat-value" id="stat-failed">0</span>
              <span class="stat-label">Failed</span>
            </div>
          </div>

          <div class="card stat-card clickable" onclick="app.showView('reports')">
            <div class="stat-icon reports">
              <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="20" x2="18" y2="10"></line>
                <line x1="12" y1="20" x2="12" y2="4"></line>
                <line x1="6" y1="20" x2="6" y2="14"></line>
              </svg>
            </div>
            <div class="stat-content">
              <span class="stat-value" id="stat-reports">0</span>
              <span class="stat-label">Reports</span>
            </div>
          </div>
        </div>

        <div class="dashboard-row">
          <div class="card">
            <div class="card-header">
              <h3>Recent Test Runs</h3>
            </div>
            <div class="card-body">
              <div id="recent-runs" class="runs-list">
                <p class="empty-state">No recent test runs</p>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <h3>Quick Actions</h3>
            </div>
            <div class="card-body">
              <div class="quick-actions">
                <a class="action-btn primary-action" href="/builder.html">
                  <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="12" y1="8" x2="12" y2="16"></line>
                    <line x1="8" y1="12" x2="16" y2="12"></line>
                  </svg>
                  Visual Builder
                </a>
                <button class="action-btn" onclick="app.showView('flows')">
                  <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                  </svg>
                  New Flow
                </button>
                <button class="action-btn" onclick="app.showView('runner')">
                  <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="5 3 19 12 5 21 5 3"></polygon>
                  </svg>
                  Run Tests
                </button>
                <button class="action-btn" onclick="app.showView('reports')">
                  <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                  </svg>
                  View Reports
                </button>
                <button class="action-btn" onclick="app.showView('editor')">
                  <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                  </svg>
                  Edit Flows
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Projects View -->
      <section id="view-projects" class="view">
        <header class="view-header">
          <h2>All Projects</h2>
          <div class="header-actions">
            <button class="btn btn-primary" onclick="app.showNewProjectModal()">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
              </svg>
              New Project
            </button>
          </div>
        </header>
        <div id="projects-list" class="projects-grid">
          <p class="empty-state">Loading projects...</p>
        </div>
      </section>

      <!-- Flows View -->
      <section id="view-flows" class="view">
        <header class="view-header">
          <h2>Test Flows</h2>
          <div class="header-actions">
            <button class="btn btn-secondary" onclick="app.loadFlows()">Refresh</button>
            <button class="btn btn-secondary" onclick="app.showImportModal()">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="17 8 12 3 7 8"></polyline>
                <line x1="12" y1="3" x2="12" y2="15"></line>
              </svg>
              Import Excel
            </button>
            <button class="btn btn-primary" onclick="app.showNewFlowModal()">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
              </svg>
              New Flow
            </button>
          </div>
        </header>
        <div class="card">
          <div class="card-body">
            <div id="flows-list" class="flows-grid">
              <p class="empty-state">Loading flows...</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Runner View -->
      <section id="view-runner" class="view">
        <header class="view-header">
          <h2>Test Runner</h2>
          <div class="header-actions">
            <select id="runner-select" class="select">
              <option value="">Select a flow or suite...</option>
            </select>
            <button class="btn btn-primary" id="run-btn" onclick="app.runSelected()">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                <polygon points="5 3 19 12 5 21 5 3"></polygon>
              </svg>
              Run
            </button>
          </div>
        </header>
        <div class="runner-container">
          <div class="card runner-output">
            <div class="card-header">
              <h3>Execution Log</h3>
              <button class="btn btn-sm" onclick="app.clearLog()">Clear</button>
            </div>
            <div class="card-body">
              <div id="execution-log" class="log-container">
                <p class="log-entry info">Ready to run tests...</p>
              </div>
            </div>
          </div>
          <div class="card runner-progress">
            <div class="card-header">
              <h3>Progress</h3>
            </div>
            <div class="card-body">
              <div id="progress-container">
                <div class="progress-bar">
                  <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                </div>
                <div class="progress-stats">
                  <span id="progress-text">0 / 0 steps</span>
                  <span id="progress-status">Idle</span>
                </div>
              </div>
              <div id="step-results" class="step-results"></div>
            </div>
          </div>
        </div>
      </section>

      <!-- Reports View -->
      <section id="view-reports" class="view">
        <header class="view-header">
          <h2>Test Reports</h2>
          <div class="header-actions">
            <select id="report-filter" class="select" onchange="app.filterReports(this.value)" style="margin-right: 8px;">
              <option value="all">All Reports</option>
              <option value="passed">Passed Only</option>
              <option value="failed">Failed Only</option>
            </select>
            <button class="btn btn-secondary" onclick="app.loadReports()">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="23 4 23 10 17 10"></polyline>
                <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
              </svg>
              Refresh
            </button>
          </div>
        </header>

        <!-- Reports Summary Cards -->
        <div class="reports-summary" id="reports-summary">
          <div class="summary-card total">
            <div class="summary-icon">
              <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
              </svg>
            </div>
            <div class="summary-info">
              <span class="summary-value" id="total-reports">0</span>
              <span class="summary-label">Total Reports</span>
            </div>
          </div>
          <div class="summary-card passed">
            <div class="summary-icon">
              <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                <polyline points="22 4 12 14.01 9 11.01"></polyline>
              </svg>
            </div>
            <div class="summary-info">
              <span class="summary-value" id="passed-reports">0</span>
              <span class="summary-label">Passed</span>
            </div>
          </div>
          <div class="summary-card failed">
            <div class="summary-icon">
              <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="15" y1="9" x2="9" y2="15"></line>
                <line x1="9" y1="9" x2="15" y2="15"></line>
              </svg>
            </div>
            <div class="summary-info">
              <span class="summary-value" id="failed-reports">0</span>
              <span class="summary-label">Failed</span>
            </div>
          </div>
          <div class="summary-card rate">
            <div class="summary-icon">
              <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="20" x2="18" y2="10"></line>
                <line x1="12" y1="20" x2="12" y2="4"></line>
                <line x1="6" y1="20" x2="6" y2="14"></line>
              </svg>
            </div>
            <div class="summary-info">
              <span class="summary-value" id="pass-rate">0%</span>
              <span class="summary-label">Pass Rate</span>
            </div>
          </div>
        </div>

        <!-- Reports Table -->
        <div class="card">
          <div class="card-header">
            <h3>Execution History</h3>
            <span id="reports-count" class="badge">0 reports</span>
          </div>
          <div class="card-body" style="padding: 0;">
            <div class="reports-table-container">
              <table class="reports-table" id="reports-table">
                <thead>
                  <tr>
                    <th>Status</th>
                    <th>Test Name</th>
                    <th>Description</th>
                    <th>Test Cases</th>
                    <th>Duration</th>
                    <th>Executed</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="reports-list">
                  <tr>
                    <td colspan="7" class="empty-cell">Loading reports...</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Report Detail Modal -->
        <div id="report-detail-modal" class="modal-overlay" style="display: none;">
          <div class="modal report-modal">
            <div class="modal-header">
              <h3 id="report-detail-title">Report Details</h3>
              <button class="modal-close" onclick="app.closeReportDetail()">&times;</button>
            </div>
            <div class="modal-body" id="report-content">
            </div>
          </div>
        </div>
      </section>

      <!-- Performance Testing View -->
      <section id="view-performance" class="view">
        <header class="view-header">
          <h2>Performance Testing</h2>
          <div class="header-actions">
            <button class="btn btn-secondary" onclick="app.loadPerformanceReports()">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="23 4 23 10 17 10"></polyline>
                <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
              </svg>
              Refresh
            </button>
          </div>
        </header>

        <!-- Performance Type Tabs -->
        <div class="perf-tabs">
          <button class="perf-tab active" data-tab="load" onclick="app.switchPerfTab('load')">Load Testing</button>
          <button class="perf-tab" data-tab="page" onclick="app.switchPerfTab('page')">Page Performance</button>
          <button class="perf-tab" data-tab="api" onclick="app.switchPerfTab('api')">API Performance</button>
          <button class="perf-tab" data-tab="history" onclick="app.switchPerfTab('history')">History</button>
        </div>

        <!-- Load Testing Panel -->
        <div id="perf-load" class="perf-panel active">
          <div class="perf-layout">
            <div class="perf-form-panel">
              <div class="card">
                <div class="card-header">
                  <h3>Load Test Configuration</h3>
                </div>
                <div class="card-body">
                  <div class="form-group">
                    <label>Target URL</label>
                    <input type="url" id="load-target-url" class="form-input" placeholder="https://example.com" />
                  </div>
                  <div class="form-row">
                    <div class="form-group">
                      <label>Method</label>
                      <select id="load-method" class="form-input">
                        <option value="GET">GET</option>
                        <option value="POST">POST</option>
                        <option value="PUT">PUT</option>
                        <option value="DELETE">DELETE</option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label>Virtual Users</label>
                      <input type="number" id="load-users" class="form-input" value="10" min="1" max="100" />
                    </div>
                  </div>
                  <div class="form-row">
                    <div class="form-group">
                      <label>Duration (seconds)</label>
                      <input type="number" id="load-duration" class="form-input" value="30" min="5" max="300" />
                    </div>
                    <div class="form-group">
                      <label>Ramp-up (seconds)</label>
                      <input type="number" id="load-rampup" class="form-input" value="5" min="0" max="60" />
                    </div>
                  </div>
                  <button class="btn btn-primary btn-block" onclick="app.runLoadTest()" id="btn-run-load-test">
                    <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                      <polygon points="5 3 19 12 5 21 5 3"></polygon>
                    </svg>
                    Run Load Test
                  </button>
                </div>
              </div>
            </div>
            <div class="perf-results-panel">
              <div class="card">
                <div class="card-header">
                  <h3>Results</h3>
                </div>
                <div class="card-body">
                  <div id="load-test-results" class="perf-results-empty">
                    <svg viewBox="0 0 24 24" width="48" height="48" fill="none" stroke="currentColor" stroke-width="1.5">
                      <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"></path>
                    </svg>
                    <p>Run a load test to see results</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Page Performance Panel -->
        <div id="perf-page" class="perf-panel">
          <div class="perf-layout">
            <div class="perf-form-panel">
              <div class="card">
                <div class="card-header">
                  <h3>Web Vitals Measurement</h3>
                </div>
                <div class="card-body">
                  <div class="form-group">
                    <label>URLs (one per line)</label>
                    <textarea id="page-urls" class="form-textarea" rows="5" placeholder="https://example.com&#10;https://example.com/about"></textarea>
                  </div>
                  <button class="btn btn-primary btn-block" onclick="app.runPagePerformance()" id="btn-run-page-perf">
                    <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                      <polygon points="5 3 19 12 5 21 5 3"></polygon>
                    </svg>
                    Measure Web Vitals
                  </button>
                </div>
              </div>
            </div>
            <div class="perf-results-panel">
              <div class="card">
                <div class="card-header">
                  <h3>Core Web Vitals</h3>
                </div>
                <div class="card-body">
                  <div id="page-perf-results" class="perf-results-empty">
                    <svg viewBox="0 0 24 24" width="48" height="48" fill="none" stroke="currentColor" stroke-width="1.5">
                      <circle cx="12" cy="12" r="10"></circle>
                      <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                    <p>Measure page performance to see Web Vitals</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- API Performance Panel -->
        <div id="perf-api" class="perf-panel">
          <div class="perf-layout">
            <div class="perf-form-panel">
              <div class="card">
                <div class="card-header">
                  <h3>API Performance Test</h3>
                </div>
                <div class="card-body">
                  <div class="form-group">
                    <label>API URL</label>
                    <input type="url" id="api-url" class="form-input" placeholder="https://api.example.com/endpoint" />
                  </div>
                  <div class="form-row">
                    <div class="form-group">
                      <label>Method</label>
                      <select id="api-method" class="form-input">
                        <option value="GET">GET</option>
                        <option value="POST">POST</option>
                        <option value="PUT">PUT</option>
                        <option value="DELETE">DELETE</option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label>Iterations</label>
                      <input type="number" id="api-iterations" class="form-input" value="50" min="1" max="500" />
                    </div>
                  </div>
                  <button class="btn btn-primary btn-block" onclick="app.runApiPerformance()" id="btn-run-api-perf">
                    <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                      <polygon points="5 3 19 12 5 21 5 3"></polygon>
                    </svg>
                    Run API Test
                  </button>
                </div>
              </div>
            </div>
            <div class="perf-results-panel">
              <div class="card">
                <div class="card-header">
                  <h3>API Metrics</h3>
                </div>
                <div class="card-body">
                  <div id="api-perf-results" class="perf-results-empty">
                    <svg viewBox="0 0 24 24" width="48" height="48" fill="none" stroke="currentColor" stroke-width="1.5">
                      <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                    </svg>
                    <p>Run an API test to see response metrics</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- History Panel -->
        <div id="perf-history" class="perf-panel">
          <div class="card">
            <div class="card-header">
              <h3>Performance Test History</h3>
            </div>
            <div class="card-body">
              <div id="perf-history-list" class="perf-history-empty">
                <p>No performance tests recorded yet</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Performance Report Detail Modal -->
        <div id="perf-report-modal" class="modal-overlay" style="display: none;">
          <div class="modal perf-report-modal">
            <div class="modal-header">
              <h3 id="perf-report-title">Performance Report</h3>
              <button class="modal-close" onclick="app.closePerfReportModal()">&times;</button>
            </div>
            <div class="modal-body" id="perf-report-content">
            </div>
            <div class="modal-footer">
              <button class="btn btn-secondary" onclick="app.closePerfReportModal()">Close</button>
              <button class="btn btn-primary" onclick="app.downloadPerfReportXls()">
                <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                  <polyline points="7 10 12 15 17 10"></polyline>
                  <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
                Download XLS
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- Repository View -->
      <section id="view-repository" class="view">
        <header class="view-header">
          <h2>Object Repository</h2>
          <div class="header-actions">
            <button class="btn btn-secondary" onclick="app.loadRepository()">Refresh</button>
            <button class="btn btn-primary" onclick="app.saveRepository()">Save</button>
          </div>
        </header>
        <div class="card">
          <div class="card-body">
            <div id="repository-editor">
              <textarea id="repository-content" class="code-editor" placeholder="# Object Repository (YAML)"></textarea>
            </div>
          </div>
        </div>
      </section>

      <!-- Editor View -->
      <section id="view-editor" class="view">
        <header class="view-header">
          <h2>Flow Editor</h2>
          <div class="header-actions">
            <select id="editor-select" class="select" onchange="app.loadFlowForEdit()">
              <option value="">Select a flow to edit...</option>
            </select>
            <div class="editor-mode-toggle">
              <button class="mode-btn active" id="btn-visual-mode" onclick="app.setEditorMode('visual')">
                <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="3" y="3" width="7" height="7"></rect>
                  <rect x="14" y="3" width="7" height="7"></rect>
                  <rect x="14" y="14" width="7" height="7"></rect>
                  <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                Visual
              </button>
              <button class="mode-btn" id="btn-yaml-mode" onclick="app.setEditorMode('yaml')">
                <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="16 18 22 12 16 6"></polyline>
                  <polyline points="8 6 2 12 8 18"></polyline>
                </svg>
                YAML
              </button>
            </div>
            <button class="btn btn-primary" onclick="app.saveFlow()">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                <polyline points="17 21 17 13 7 13 7 21"></polyline>
                <polyline points="7 3 7 8 15 8"></polyline>
              </svg>
              Save
            </button>
          </div>
        </header>

        <!-- Visual Editor Mode -->
        <div id="editor-visual-mode" class="editor-visual-container">
          <div class="editor-visual-layout">
            <!-- Left: Flow Info & Steps -->
            <div class="editor-main-panel">
              <!-- Flow Info -->
              <div class="card editor-flow-info">
                <div class="card-header">
                  <h3>Flow Information</h3>
                </div>
                <div class="card-body">
                  <div class="form-row">
                    <label>Flow Name *</label>
                    <input type="text" id="editor-flow-name" placeholder="e.g., Login Test" onchange="app.editorUpdateYaml()">
                  </div>
                  <div class="form-row">
                    <label>Description</label>
                    <input type="text" id="editor-flow-desc" placeholder="e.g., Test user login functionality" onchange="app.editorUpdateYaml()">
                  </div>
                  <div class="form-row">
                    <label>Runner</label>
                    <select id="editor-flow-runner" onchange="app.editorUpdateYaml()">
                      <option value="web">Web (Browser)</option>
                      <option value="api">API (HTTP)</option>
                    </select>
                  </div>
                </div>
              </div>

              <!-- Steps List -->
              <div class="card editor-steps-card">
                <div class="card-header">
                  <h3>Test Steps <span id="editor-steps-count">(0 steps)</span></h3>
                  <button class="btn btn-sm btn-primary" onclick="app.editorAddStep()">
                    <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="12" y1="5" x2="12" y2="19"></line>
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    Add Step
                  </button>
                </div>
                <div class="card-body editor-steps-list" id="editor-steps-list">
                  <div class="empty-steps" id="editor-empty-steps">
                    <svg viewBox="0 0 24 24" width="48" height="48" fill="none" stroke="currentColor" stroke-width="1.5">
                      <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                      <line x1="12" y1="8" x2="12" y2="16"></line>
                      <line x1="8" y1="12" x2="16" y2="12"></line>
                    </svg>
                    <p><strong>No steps yet</strong></p>
                    <p>Click "Add Step" to add your first test step</p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Right: Actions Panel -->
            <div class="editor-actions-panel">
              <div class="card">
                <div class="card-header">
                  <h3>Quick Add</h3>
                </div>
                <div class="card-body">
                  <p style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 16px;">
                    Click to add a step
                  </p>
                  <div class="quick-actions-grid">
                    <button class="quick-action-btn" onclick="app.editorQuickAdd('goto')">
                      <span class="icon">üåê</span> Go to URL
                    </button>
                    <button class="quick-action-btn" onclick="app.editorQuickAdd('click')">
                      <span class="icon">üëÜ</span> Click
                    </button>
                    <button class="quick-action-btn" onclick="app.editorQuickAdd('fill')">
                      <span class="icon">‚úèÔ∏è</span> Fill Input
                    </button>
                    <button class="quick-action-btn" onclick="app.editorQuickAdd('select')">
                      <span class="icon">üìã</span> Select
                    </button>
                    <button class="quick-action-btn" onclick="app.editorQuickAdd('expectVisible')">
                      <span class="icon">üëÅÔ∏è</span> Check Visible
                    </button>
                    <button class="quick-action-btn" onclick="app.editorQuickAdd('expectText')">
                      <span class="icon">üìù</span> Check Text
                    </button>
                    <button class="quick-action-btn" onclick="app.editorQuickAdd('wait')">
                      <span class="icon">‚è±Ô∏è</span> Wait
                    </button>
                    <button class="quick-action-btn" onclick="app.editorQuickAdd('screenshot')">
                      <span class="icon">üì∑</span> Screenshot
                    </button>
                    <button class="quick-action-btn" onclick="app.editorQuickAdd('hover')">
                      <span class="icon">üñ±Ô∏è</span> Hover
                    </button>
                    <button class="quick-action-btn" onclick="app.editorQuickAdd('waitForLoadState')">
                      <span class="icon">‚è≥</span> Wait Load
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- YAML Editor Mode -->
        <div id="editor-yaml-mode" class="editor-yaml-container" style="display: none;">
          <div class="editor-container">
            <div class="card">
              <div class="card-header">
                <h3>YAML Editor</h3>
                <span style="font-size: 0.75rem; color: var(--text-muted);">Edit the raw YAML directly</span>
              </div>
              <div class="card-body">
                <textarea id="flow-editor" class="code-editor" placeholder="# Select a flow to edit or create a new one"></textarea>
              </div>
            </div>
            <div class="card editor-preview">
              <div class="card-header">
                <h3>Preview</h3>
              </div>
              <div class="card-body">
                <div id="flow-preview"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Step Edit Modal -->
        <div id="step-edit-modal" class="modal-overlay" style="display: none;">
          <div class="modal step-edit-modal">
            <div class="modal-header">
              <h3 id="step-edit-title">Edit Step</h3>
              <button class="modal-close" onclick="app.closeStepEditModal()">&times;</button>
            </div>
            <div class="modal-body" id="step-edit-content">
            </div>
            <div class="modal-footer">
              <button class="btn btn-secondary" onclick="app.closeStepEditModal()">Cancel</button>
              <button class="btn btn-primary" onclick="app.saveStepEdit()">Save Step</button>
            </div>
          </div>
        </div>
      </section>

      <!-- Settings View -->
      <section id="view-settings" class="view">
        <header class="view-header">
          <h2>Settings</h2>
        </header>
        <div class="card">
          <div class="card-header">
            <h3>Project Configuration</h3>
          </div>
          <div class="card-body">
            <div class="settings-form">
              <div class="form-group">
                <label>Project Path</label>
                <input type="text" id="setting-project-path" class="input" readonly>
              </div>
              <div class="form-group">
                <label>Browser</label>
                <select id="setting-browser" class="select">
                  <option value="chromium">Chromium</option>
                  <option value="firefox">Firefox</option>
                  <option value="webkit">WebKit</option>
                </select>
              </div>
              <div class="form-group">
                <label>Headless Mode</label>
                <label class="switch">
                  <input type="checkbox" id="setting-headless" checked>
                  <span class="slider"></span>
                </label>
              </div>
              <div class="form-group">
                <label>Screenshot on Failure</label>
                <label class="switch">
                  <input type="checkbox" id="setting-screenshot" checked>
                  <span class="slider"></span>
                </label>
              </div>
              <div class="form-group">
                <label>Timeout (ms)</label>
                <input type="number" id="setting-timeout" class="input" value="30000">
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Visual Builder View -->
      <section id="view-builder" class="view">
        <header class="view-header">
          <h2>Visual Test Builder</h2>
          <div class="header-actions">
            <button class="btn btn-secondary" onclick="app.builderClearAll()">Clear All</button>
            <button class="btn btn-secondary" onclick="app.builderLoadExisting()">Load Existing</button>
            <button class="btn btn-primary" onclick="app.builderSaveTest()">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                <polyline points="17 21 17 13 7 13 7 21"></polyline>
                <polyline points="7 3 7 8 15 8"></polyline>
              </svg>
              Save Test
            </button>
          </div>
        </header>

        <!-- Recording Panel -->
        <div class="recording-panel" id="builder-recording-panel">
          <h2>
            <svg viewBox="0 0 24 24" width="28" height="28" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <circle cx="12" cy="12" r="4" fill="currentColor"></circle>
            </svg>
            Record Your Test
          </h2>
          <p class="subtitle">Enter a URL, click Start, perform your actions in the browser, then click Stop to generate your test.</p>

          <div class="record-controls">
            <input type="text" id="builder-record-url" class="record-url-input" placeholder="https://www.example.com" value="https://www.mohawkgroup.com">
            <button class="btn-record start" id="btn-builder-start-record" onclick="app.builderStartRecording()">
              <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                <circle cx="12" cy="12" r="8"></circle>
              </svg>
              Start Recording
            </button>
            <button class="btn-record stop" id="btn-builder-stop-record" onclick="app.builderStopRecording()" style="display: none;">
              <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                <rect x="6" y="6" width="12" height="12" rx="2"></rect>
              </svg>
              Stop Recording
            </button>
          </div>

          <div class="recording-status" id="builder-recording-status">
            <span class="recording-dot"></span>
            <span class="message">Recording in progress...</span>
            <span class="step-count" id="builder-recorded-step-count">0 actions captured</span>
          </div>
          <div id="builder-last-recorded-action"></div>
        </div>

        <!-- Method Tabs -->
        <div class="method-tabs">
          <button class="method-tab active" onclick="app.builderSwitchMethod('record')">Record Mode</button>
          <button class="method-tab" onclick="app.builderSwitchMethod('manual')">Manual Mode</button>
        </div>

        <div class="builder-container">
          <!-- Left Sidebar - Available Actions -->
          <div class="builder-sidebar" id="builder-manual-sidebar">
            <h3 style="margin-bottom: 20px;">Available Actions</h3>
            <p style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 20px;">Click on an action to add it to your test.</p>

            <div class="action-category">
              <h4>Navigation</h4>
              <div class="action-card" onclick="app.builderAddStep('goto')">
                <div class="action-card-title"><span class="icon">1</span> Go to URL</div>
                <div class="action-card-desc">Navigate to a web page</div>
              </div>
              <div class="action-card" onclick="app.builderAddStep('waitForLoadState')">
                <div class="action-card-title"><span class="icon">2</span> Wait for Page Load</div>
                <div class="action-card-desc">Wait until page is fully loaded</div>
              </div>
            </div>

            <div class="action-category">
              <h4>Click & Input</h4>
              <div class="action-card" onclick="app.builderAddStep('click')">
                <div class="action-card-title"><span class="icon">3</span> Click Element</div>
                <div class="action-card-desc">Click on a button, link, or element</div>
              </div>
              <div class="action-card" onclick="app.builderAddStep('fill')">
                <div class="action-card-title"><span class="icon">4</span> Fill Text Field</div>
                <div class="action-card-desc">Enter text in an input field</div>
              </div>
              <div class="action-card" onclick="app.builderAddStep('select')">
                <div class="action-card-title"><span class="icon">5</span> Select Dropdown</div>
                <div class="action-card-desc">Select an option from dropdown</div>
              </div>
              <div class="action-card" onclick="app.builderAddStep('hover')">
                <div class="action-card-title"><span class="icon">6</span> Hover Over Element</div>
                <div class="action-card-desc">Move mouse over an element</div>
              </div>
            </div>

            <div class="action-category">
              <h4>Verification</h4>
              <div class="action-card" onclick="app.builderAddStep('expectVisible')">
                <div class="action-card-title"><span class="icon">7</span> Check Element Visible</div>
                <div class="action-card-desc">Verify an element is visible</div>
              </div>
              <div class="action-card" onclick="app.builderAddStep('expectText')">
                <div class="action-card-title"><span class="icon">8</span> Check Text Content</div>
                <div class="action-card-desc">Verify element contains text</div>
              </div>
            </div>

            <div class="action-category">
              <h4>Wait & Screenshot</h4>
              <div class="action-card" onclick="app.builderAddStep('wait')">
                <div class="action-card-title"><span class="icon">9</span> Wait (Pause)</div>
                <div class="action-card-desc">Pause execution for specified time</div>
              </div>
              <div class="action-card" onclick="app.builderAddStep('screenshot')">
                <div class="action-card-title"><span class="icon">10</span> Take Screenshot</div>
                <div class="action-card-desc">Capture a screenshot of the page</div>
              </div>
            </div>
          </div>

          <!-- Main Area - Test Steps -->
          <div class="builder-main">
            <div class="test-info">
              <h3>Test Information</h3>
              <div class="form-row">
                <label>Test Name</label>
                <input type="text" id="builder-test-name" placeholder="e.g., Homepage Smoke Test" value="My New Test" onchange="app.builderUpdatePreview()">
              </div>
              <div class="form-row">
                <label>Description</label>
                <input type="text" id="builder-test-desc" placeholder="e.g., Verify homepage loads correctly" onchange="app.builderUpdatePreview()">
              </div>
              <div class="form-row">
                <label>Base URL</label>
                <input type="text" id="builder-test-baseurl" placeholder="e.g., https://www.mohawkgroup.com" value="https://www.mohawkgroup.com">
                <div class="form-hint">The starting URL for your test</div>
              </div>
            </div>

            <div class="steps-header">
              <h3>Test Steps <span id="builder-step-count" style="color: var(--text-muted); font-weight: normal;">(0 steps)</span></h3>
              <button class="btn btn-sm btn-primary" onclick="app.builderShowQuickAdd()">+ Add Step</button>
            </div>

            <div class="steps-list" id="builder-steps-list">
              <div class="empty-steps" id="builder-empty-steps">
                <svg viewBox="0 0 24 24" width="64" height="64" fill="none" stroke="currentColor" stroke-width="1.5">
                  <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                  <line x1="12" y1="8" x2="12" y2="16"></line>
                  <line x1="8" y1="12" x2="16" y2="12"></line>
                </svg>
                <p><strong>No steps added yet</strong></p>
                <p>Click on an action from the left panel to add your first step</p>
              </div>
            </div>

            <div class="builder-toolbar">
              <button class="btn btn-secondary" onclick="app.builderRunTest()">
                <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                  <polygon points="5 3 19 12 5 21 5 3"></polygon>
                </svg>
                Run Test
              </button>
            </div>
          </div>

          <!-- Right Sidebar - Preview -->
          <div class="builder-preview">
            <div class="preview-header">
              <h3>Generated YAML Preview</h3>
              <p style="font-size: 0.75rem; color: var(--text-muted); margin-top: 4px;">This is the test file that will be created</p>
            </div>
            <pre class="preview-content" id="builder-yaml-preview"># Your test will appear here...</pre>
          </div>
        </div>
      </section>

      <!-- Quick Add Modal for Builder -->
      <div class="modal-backdrop" id="builder-quick-add-backdrop" onclick="app.builderHideQuickAdd()"></div>
      <div class="quick-add-modal" id="builder-quick-add-modal">
        <h3>Add New Step</h3>
        <div class="form-row">
          <label>What do you want to do?</label>
          <select id="builder-quick-action-type" onchange="app.builderUpdateQuickAddForm()">
            <option value="">-- Select an action --</option>
            <optgroup label="Navigation">
              <option value="goto">Go to URL - Navigate to a web page</option>
              <option value="waitForLoadState">Wait for Page Load - Wait until page loads</option>
            </optgroup>
            <optgroup label="Click & Input">
              <option value="click">Click Element - Click on button/link</option>
              <option value="fill">Fill Text Field - Enter text in input</option>
              <option value="select">Select Dropdown - Choose dropdown option</option>
              <option value="hover">Hover Over Element - Mouse over element</option>
            </optgroup>
            <optgroup label="Verification">
              <option value="expectVisible">Check Element Visible - Verify element shows</option>
              <option value="expectText">Check Text Content - Verify text exists</option>
            </optgroup>
            <optgroup label="Wait & Screenshot">
              <option value="wait">Wait (Pause) - Pause for some time</option>
              <option value="screenshot">Take Screenshot - Capture the page</option>
            </optgroup>
          </select>
        </div>
        <div id="builder-quick-add-fields"></div>
        <div style="display: flex; gap: 12px; justify-content: flex-end; margin-top: 20px;">
          <button class="btn btn-secondary" onclick="app.builderHideQuickAdd()">Cancel</button>
          <button class="btn btn-primary" onclick="app.builderConfirmQuickAdd()">Add Step</button>
        </div>
      </div>
    </main>
  </div>

  <!-- Modal for new flow -->
  <div id="modal-overlay" class="modal-overlay" style="display: none;">
    <div class="modal">
      <div class="modal-header">
        <h3>Create New Flow</h3>
        <button class="modal-close" onclick="app.closeModal()">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>Flow Name</label>
          <input type="text" id="new-flow-name" class="input" placeholder="my_test_flow">
        </div>
        <div class="form-group">
          <label>Runner Type</label>
          <select id="new-flow-runner" class="select">
            <option value="web">Web (Playwright)</option>
            <option value="api">API (HTTP)</option>
            <option value="desktop">Desktop (Windows)</option>
            <option value="mobile">Mobile (Android)</option>
          </select>
        </div>
        <div class="form-group">
          <label>Description</label>
          <input type="text" id="new-flow-description" class="input" placeholder="Test description">
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="app.closeModal()">Cancel</button>
        <button class="btn btn-primary" onclick="app.createNewFlow()">Create</button>
      </div>
    </div>
  </div>

  <!-- Modal for new project -->
  <div id="project-modal-overlay" class="modal-overlay" style="display: none;">
    <div class="modal">
      <div class="modal-header">
        <h3>Create New Project</h3>
        <button class="modal-close" onclick="app.closeProjectModal()">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>Project Name</label>
          <input type="text" id="new-project-name" class="input" placeholder="e.g., Mohawk Group">
        </div>
        <div class="form-group">
          <label>Base URL</label>
          <input type="text" id="new-project-url" class="input" placeholder="e.g., https://www.mohawkgroup.com">
        </div>
        <div class="form-group">
          <label>Description</label>
          <input type="text" id="new-project-description" class="input" placeholder="Test suite for...">
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="app.closeProjectModal()">Cancel</button>
        <button class="btn btn-primary" onclick="app.createNewProject()">Create Project</button>
      </div>
    </div>
  </div>

  <!-- Modal for Excel import -->
  <div id="import-modal-overlay" class="modal-overlay" style="display: none;">
    <div class="modal" style="max-width: 560px;">
      <div class="modal-header">
        <h3>Import Test Cases from Excel</h3>
        <button class="modal-close" onclick="app.closeImportModal()">&times;</button>
      </div>
      <div class="modal-body">
        <div class="import-instructions">
          <p style="color: var(--text-secondary); margin-bottom: 16px;">
            Upload an Excel file (.xlsx) with the following columns:
          </p>
          <ul style="color: var(--text-muted); margin-bottom: 20px; padding-left: 20px;">
            <li><strong>Test Case ID</strong> - Unique identifier (e.g., TC001)</li>
            <li><strong>Test Case Description</strong> - Brief description of the test</li>
            <li><strong>Test Steps</strong> - Actions to perform (one per line or semicolon-separated)</li>
          </ul>
        </div>
        <div class="form-group">
          <label>Select Excel File</label>
          <div class="file-upload-area" id="file-upload-area" onclick="document.getElementById('excel-file-input').click()">
            <svg viewBox="0 0 24 24" width="48" height="48" fill="none" stroke="currentColor" stroke-width="1.5" style="color: var(--text-muted); margin-bottom: 12px;">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="17 8 12 3 7 8"></polyline>
              <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
            <p id="file-upload-text" style="color: var(--text-secondary);">Click to select or drag & drop an Excel file</p>
            <p style="color: var(--text-muted); font-size: 0.75rem; margin-top: 8px;">Supports .xlsx files</p>
          </div>
          <input type="file" id="excel-file-input" accept=".xlsx,.xls" style="display: none;" onchange="app.handleFileSelect(event)">
        </div>
        <div id="import-preview" style="display: none;">
          <div class="form-group">
            <label>Selected File</label>
            <div class="selected-file" id="selected-file-info">
              <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" style="color: var(--success);">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
              </svg>
              <span id="selected-file-name">file.xlsx</span>
              <button class="btn btn-sm btn-secondary" onclick="app.clearFileSelection()">Change</button>
            </div>
          </div>
        </div>
        <div id="import-progress" style="display: none;">
          <div class="progress-bar" style="margin-bottom: 8px;">
            <div class="progress-fill" id="import-progress-fill" style="width: 0%"></div>
          </div>
          <p id="import-status" style="color: var(--text-muted); font-size: 0.875rem; text-align: center;">Importing...</p>
        </div>
        <div id="import-results" style="display: none;">
          <div class="import-results-summary">
            <div class="import-result-stat success">
              <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="20 6 9 17 4 12"></polyline>
              </svg>
              <span id="import-success-count">0</span> imported
            </div>
            <div class="import-result-stat error">
              <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
              </svg>
              <span id="import-error-count">0</span> failed
            </div>
          </div>
          <div id="import-error-list" style="display: none; margin-top: 12px;">
            <label style="color: var(--text-muted); font-size: 0.75rem; margin-bottom: 4px; display: block;">Errors:</label>
            <div id="import-errors" style="max-height: 120px; overflow-y: auto; font-size: 0.75rem; color: var(--danger);"></div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="app.closeImportModal()">Cancel</button>
        <button class="btn btn-primary" id="import-btn" onclick="app.importExcel()" disabled>
          <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="17 8 12 3 7 8"></polyline>
            <line x1="12" y1="3" x2="12" y2="15"></line>
          </svg>
          Import
        </button>
      </div>
    </div>
  </div>

  <!-- Toast notifications -->
  <div id="toast-container"></div>

  <script src="/app.js"></script>
</body>
</html>
